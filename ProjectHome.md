An attempt at refactoring as much of the 474 client as possible.